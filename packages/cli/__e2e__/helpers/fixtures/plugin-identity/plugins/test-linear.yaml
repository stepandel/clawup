name: test-linear
displayName: Test Linear
installable: true
needsFunnel: true
configPath: plugins.entries
secrets:
  apiKey:
    envVar: LINEAR_API_KEY
    scope: agent
    isSecret: true
    required: true
    autoResolvable: false
    validator: "lin_api_"
  webhookSecret:
    envVar: LINEAR_WEBHOOK_SECRET
    scope: agent
    isSecret: true
    required: true
    autoResolvable: false
  linearUserUuid:
    envVar: LINEAR_USER_UUID
    scope: agent
    isSecret: false
    required: false
    autoResolvable: true
internalKeys:
  - agentId
  - linearUserUuid
configTransforms: []
webhookSetup:
  urlPath: "/hooks/linear"
  secretKey: webhookSecret
  instructions:
    - "1. Create webhook"
    - "2. Paste URL"
  configJsonPath: "plugins.entries.test-linear.config.webhookSecret"
hooks:
  resolve:
    linearUserUuid: 'echo "test-resolved-uuid-$(echo $LINEAR_API_KEY | cut -c1-8)"'
  onboard:
    description: "Set up test Linear webhook integration"
    inputs:
      configToken:
        envVar: TEST_LINEAR_CONFIG_TOKEN
        prompt: "Test Linear config token"
        instructions: "Generate a test config token from the test panel"
        validator: "tlct-"
    script: |
      echo "Onboard hook received config token: $TEST_LINEAR_CONFIG_TOKEN"
      echo "Onboard hook received API key present: $(test -n "$LINEAR_API_KEY" && echo yes || echo no)"
      echo "Webhook configured successfully for test-linear plugin"
    runOnce: false
