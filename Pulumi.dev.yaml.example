# Pulumi Stack Configuration - Development Environment
#
# This configuration pulls secrets from Pulumi ESC.
# See esc/agent-army-secrets.yaml.example for the ESC environment template.
#
# Setup:
#   1. Create ESC environment: pulumi env init <org>/agent-army-dev
#   2. Copy secrets from esc/agent-army-secrets.yaml.example
#   3. Run: pulumi up

environment:
  - agent-army-dev

config:
  # AWS region for deployment
  aws:region: us-east-1

  # Tailscale DNS name (your tailnet domain)
  # Example: tail12345.ts.net
  agent-army:tailnetDnsName: ${esc:tailnetDnsName}

  # Instance type for all agents
  # WARNING: t3.micro is too small (1GB RAM insufficient)
  agent-army:instanceType: t3.medium

  # Owner name (used in workspace templates)
  agent-army:ownerName: ${esc:ownerName}

  # Shared secrets (pulled from ESC)
  agent-army:anthropicApiKey:
    fn::secret: ${esc:anthropicApiKey}
  agent-army:tailscaleAuthKey:
    fn::secret: ${esc:tailscaleAuthKey}

  # =========================================================================
  # Per-agent Slack credentials (Socket Mode)
  # =========================================================================
  # Bot Token (xoxb-...) + App Token (xapp-...) for each agent

  agent-army:pmSlackBotToken:
    fn::secret: ${esc:pmSlackBotToken}
  agent-army:pmSlackAppToken:
    fn::secret: ${esc:pmSlackAppToken}

  agent-army:engSlackBotToken:
    fn::secret: ${esc:engSlackBotToken}
  agent-army:engSlackAppToken:
    fn::secret: ${esc:engSlackAppToken}

  agent-army:testerSlackBotToken:
    fn::secret: ${esc:testerSlackBotToken}
  agent-army:testerSlackAppToken:
    fn::secret: ${esc:testerSlackAppToken}

  # =========================================================================
  # Per-agent Linear credentials
  # =========================================================================

  agent-army:pmLinearApiKey:
    fn::secret: ${esc:pmLinearApiKey}
  agent-army:engLinearApiKey:
    fn::secret: ${esc:engLinearApiKey}
  agent-army:testerLinearApiKey:
    fn::secret: ${esc:testerLinearApiKey}

  # =========================================================================
  # Per-agent Brave Search API keys (optional)
  # =========================================================================

  agent-army:pmBraveSearchApiKey:
    fn::secret: ${esc:pmBraveSearchApiKey}
  agent-army:engBraveSearchApiKey:
    fn::secret: ${esc:engBraveSearchApiKey}
  agent-army:testerBraveSearchApiKey:
    fn::secret: ${esc:testerBraveSearchApiKey}
